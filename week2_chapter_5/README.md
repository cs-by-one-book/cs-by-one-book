# 📌 기본적인 구조 요소들

![img_5-1](.\img\img_5-1.jpg)

**폰 노이만 구조**: 메모리와 명령어 동시에 가져올 수 X

**하버드 구조**: 메모리와 명령어 동시에 가져올 수 O but 버스 두 개 필요

---

## 프로세서 코어

CPU는 옛날 말, 요즘은 **프로세서 코어**(processor core)!

이 코어가 여러개 들어가면?  멀티 코어 프로세서(multi core processor)

메모리와 I/O가 같은 패키지(한 칩)에 들어 있으면? 마이크로컴퓨터(microcomputer) == 마이크로컨트롤러 == 마이크로프로세서로 만들어진 컴퓨터 시스템... 

> 다들 지 맘대로 쓴다~

다른 패키지에 들어 있으면? 마이크로프로세서(microprocessor)

마이크로프로세서는 보통 큰 시스템에 들어가는 부품으로 쓰이고, 마이크로컴퓨터는 세탁기 등에 들어가는 단일 칩으로 된 작은 컴퓨터이다.

# 📌 프로시저, 서브루틴, 함수

프로시저(procedure) == 서브루틴(subroutine) == 함수(function)

```javascript
function cube(x) {
    return (x * x * x);
}
const y = cube(3);
```

이라는 코드가 있을 때 

![5-1](.\img\table_5-1.jpg)

전체적 과정: 함수 호출 => 함수 실행 => 함수 안 모든 코드 실행 => 200번지 값 사용해 간접 분기

1. cube 함수를 실행한 다음에 돌아와야 하는(반환) 주소를 계산한다.

   1. 반환 주소를 계산하기 위해 명령어를 몇 개 사용한다.
   2. 세제곱을 계산할 숫자를 누산기에 넣는 코드
   3. cube함수를 호출하는 코드

   반환 주소는 프로그램 시작으로부터 5개의 명령어가 지난 다음 주소인 105가 된다.

2. 이 값(105)을 200번지에 넣는다.

4. 간접 분기에서 다시 돌아올 때 105로 돌아온다.

![5-2](./img\5-2.jpg)







# 인터럽트

## 소프트웨어를 이용한 해결방법

### 폴링(polling)

​	어떤 상태를 확인하기 위한 동작을 큰 작업의 사이사이에 수행하지 않고 큰 작업을 작은 하위 작업들로 나누고 하위 작업들 사이사이에 상태를 확인하는 방법

*  장점 

   정해진 순서에 따라서 명령을 반복적으로 처리하므로 프로그램 작성이 쉽고 이해하기가 쉽다. (소규모 프로그램 작성할 때 유용)

*  단점

   입출력 장치들과의 상호작용을 폴링 방식으로하는 경우 입출력 장치들이 많을 수록 CPU를 점유하는 시간이 줄어들어 작업 수행 성능이 크게 떨어진다.

   여전히 작은 작업이 끝나는 순간에만 확인할 수 있다. => 정확한 타잉에 인터럽트가 발생했는지 알 수 없다.

## 하드웨어를 이용한 해결 방법

### 인터럽트

​	CPU가 프로그램을 실행하고 있을 때, 입출력 하드웨어 등의 장치나 또는 예외상황이 방생하여 처리가 필요한 경우 CPU에 알려 처리하는 기술

*  인터럽트 시스템 

   적절한 전기 신호가 들어오면 CPU가 실행을 잠깐 중단시킬 수 있는 핀(칩에 연결된 전기적 접점)을 가지고 있다.

   프로세서 칩에는 **통합 주변장치**(온칩 I/O 장치) 들이 내부적으로 인터럽트 시스템에 연결되어 있다.

*  인터럽트 과정

   1.  CPU가 주의를 기울이는 주변장치가 **인터럽트를 요청**한다.
   2.  CPU는 현재 실행 중인 명령어를 완료한다.
   3.  프로세서는 현재 실행 중인 프로그램을 중단
   4.  **인터럽트 벡터** 탐색
   5.  인터럽트 벡터에 저장된 CPU의 인터럽트 핸들러 실행 : PC에 인터럽트 벡터에 저장값 세팅
       1.  PC (Program Counter) & SR (status Register)을 스택에 저장 (실행 중이던 프로그램 상태)
       2.  인터럽트 벡터에 해당하는 인터럽트 수행
       3.  프로그램 복구 : 스택에 저장한 PC와 SR 값 복구
   6.  중단된 프로그램 재실행 (중단된 시점 이후부터)



*  인터럽트 종류

   *  내부 인터럽트
      1.  하드웨어 고장 : 컴퓨터 고장, 데이터 전달 과정에서 비트 오류, 전원이 나간 경우
      2.  실행할 수 없는 명령어 : 인출한 명령어의 비트 패턴이 정의되어 있지 않은 경우
      3.  명령어 실행 오류 : 나누기 0
      4.  사용 권한 위배 : 운영체제만 사용할 수 있는 자원에 접근하는 경우
   *  외부 인터럽트
      1.  타이머 인터럽트 
      2.  입출력 인터럽트

*  특별한 인터럽트 제어

   *  인터럽트 실행을 막는 **마스크**

   *  인터럽트가 여러개 있는 시스템에는 **우선순위**가 있다.

      

1.  다른 프로그램은 접근할 수 없는 물리적 인터럽트에 접근하는 경우가 있다.

2.  운영체제는 일종의 **가상(virtual)** 인터럽트

3.  유닉스 운영체제는 **시그널 메커니즘 (이벤트)**

    

### 용어 정리

*  인터럽트 핸들러 (= 인터럽트 서브 루틴) : 인터럽트 요청시 반복적으로 수행하는 일
*  인터럽트 벡터 : 수행해야할 인터럽트의 주소를 가르키는 포인터

